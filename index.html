<!DOCTYPE html>
<html>
  <head>
    <title>Twitch Video Clipper</title>
    <meta name="description" content="An app to download clips from Twitch VODs">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/dist/favicon.ico">
    <style>
      * {
        box-sizing: border-box;
      }
      body, html {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
  </head>
  <body>
    <div style="width: 90%; height: auto; margin: 5% auto">
      <h1 style="text-align: center">Twitch Clipper Demo</h1>
      <p style="width: 60%; margin: 2% auto">
        Directions: Find the vodID of the video you want, input a file name to save to, put in the time you want the clip to start, and then put in the duration of the clip in seconds.
        <br>
        <br>
        Example for www.twitch.tv/sjow/v/48022188, to clip starting at 45 minutes and 30 second, for 30 seconds:
        <br>
        <code style="margin-top: 1em; display: block; text-align: center; font-weight: bold; word-spacing: 5em">
          48022188 video-48022188.webm 00:45:30.000 30
        </code>
      </p>
      <form id="videoForm" style="display: table; margin: 0 auto">
        <input type="text" value='VOD ID String' />
        <input type="text" value='Video Filename' />
        <input type="text" value='Start Time' />
        <input type="text" value='Duration' />
        <button type="submit">Save Video</button>
      </form>
      <p style="text-align: center" id="saveStatus">
        Words Here
      </p>
    </div>
    
    <script>
      var socket = io.connect('http://hearthdraft.net:3000');
      socket.emit('handshake');
      socket.on('handshake-resp', function(result) {
        console.log('result: '+result);
      });
      socket.on('saveM3U-resp', function(resp) {
        document.getElementById('saveStatus').innerHTML = resp;
        console.log(resp);
      });
      document.getElementById('videoForm').addEventListener('submit', getFormAndSave);
      function getFormAndSave(e) {
        e.preventDefault();
        var inputs = document.getElementsByTagName('input');
        var vodIdStr = inputs[0].value;
        var filename = inputs[1].value;
        var startTime = inputs[2].value;
        var duration = inputs[3].value;
        serverSaveM3U(vodIdStr, filename, startTime, duration)
      }
      function serverSaveM3U(vodIdStr, filename, startTime, duration) {
        socket.emit('saveM3U', vodIdStr, filename, startTime, duration);
      }
    </script>

  </body>
</html>
